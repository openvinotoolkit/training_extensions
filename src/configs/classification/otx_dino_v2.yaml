engine: ../engine/classification.yaml

model:
  class_path: otx.core.model.module.classification.OTXClassificationLitModule
  init_args:
    torch_compile: false
    otx_model:
      class_path: otx.algo.classification.otx_dino_v2.DINOv2RegisterClassifier
      init_args:
        config:
          backbone:
            name: dinov2_vits14_reg
            frozen: true
          head:
            in_channels: 384
            num_classes: 1000
    optimizer:
      class_path: torch.optim.AdamW
      init_args:
        lr: 1e-5
    scheduler:
      class_path: lightning.pytorch.cli.ReduceLROnPlateau
      init_args:
        monitor: train/loss

data:
  task: MULTI_CLASS_CLS
  config:
    data_format: imagenet_with_subset_dirs
    mem_cache_img_max_size:
      - 500
      - 500
    mem_cache_size: 1GB
    train_subset:
      subset_name: train
      num_workers: 2
      batch_size: 64
      transform_lib_type: MMPRETRAIN
      transforms:
        - type: LoadImageFromFile
          to_float32: true
        - mean:
            - 123.675
            - 116.28
            - 103.53
          std:
            - 58.395
            - 57.12
            - 57.375
          to_rgb: true
          type: Normalize
        - backend: cv2
          scale: 224
          type: RandomResizedCrop
        - type: PackInputs
    val_subset:
      subset_name: val
      num_workers: 2
      batch_size: 64
      transform_lib_type: MMPRETRAIN
      transforms:
        - type: LoadImageFromFile
          to_float32: true
        - backend: cv2
          edge: short
          scale: 256
          type: ResizeEdge
        - crop_size: 224
          type: CenterCrop
        - type: PackInputs
    test_subset:
      subset_name: test
      num_workers: 2
      batch_size: 64
      transform_lib_type: MMPRETRAIN
      transforms:
        - type: LoadImageFromFile
          to_float32: true
        - backend: cv2
          edge: short
          scale: 256
          type: ResizeEdge
        - crop_size: 224
          type: CenterCrop
        - type: PackInputs
