class_path: otx.core.model.module.classification.OTXClassificationLitModule
init_args:
  torch_compile: false
  otx_model:
    class_path: otx.core.model.entity.classification.MMPretrainCompatibleModel
    init_args:
      config:
        backbone:
          type: OTXMobileNetV3
        head:
          in_channels: 960
          loss:
            loss_weight: 1.0
            type: CrossEntropyLoss
          num_classes: 1000
          topk:
            - 1
            - 5
          type: LinearClsHead
        neck:
          type: GlobalAveragePooling
        data_preprocessor:
          mean:
            - 123.675
            - 116.28
            - 103.53
          std:
            - 58.395
            - 57.12
            - 57.375
          to_rgb: True
          type: ClsDataPreprocessor
        type: ImageClassifier
  optimizer:
    class_path: torch.optim.SGD
    init_args:
      lr: 0.0058
      momentum: 0.9
      weight_decay: 0.0001
  scheduler:
    class_path: lightning.pytorch.cli.ReduceLROnPlateau
    init_args:
      mode: min
      factor: 0.5
      patience: 1
      monitor: train/loss
