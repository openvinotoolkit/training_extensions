# @package _global_
defaults:
  - override /base: visual_prompting
  - override /callbacks: visual_prompting
  - override /data: mmdet_visual_prompting
  # - override /data: torchvision_visual_prompting
  - override /model: torch_visual_prompting
data:
  train_subset:
    batch_size: 2
  val_subset:
    batch_size: 1
  test_subset:
    batch_size: 1
model:
  otx_model:
    _target_: otx.algo.visual_prompting.segment_anything.OTXSegmentAnything
    config:
      backbone: tiny_vit
      load_from: "https://github.com/ChaoningZhang/MobileSAM/raw/master/weights/mobile_sam.pt"
      freeze_image_encoder: true
      freeze_prompt_encoder: true
      freeze_mask_decoder: false
    num_classes: 1
  optimizer:
    _target_: torch.optim.Adam
    _partial_: true
    lr: 0.00001
  scheduler:
    _target_: torch.optim.lr_scheduler.ConstantLR
    _partial_: true
    factor: 1
    total_iters: -1
trainer:
  max_epochs: 100