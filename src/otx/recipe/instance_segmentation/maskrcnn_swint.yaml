# @package _global_
defaults:
  - override /base: instance_segmentation
  - override /callbacks: instance_segmentation
  - override /data: mmdet_inst_seg
  - override /model: mmdet_inst_seg

data:
  train_subset:
    batch_size: 4
    transforms:
      - type: LoadImageFromFile
        backend_args: null
      - type: LoadAnnotations
        with_bbox: true
        with_mask: true
      - type: Resize
        keep_ratio: true
        scale:
          - 1344
          - 1344
      - type: RandomFlip
        prob: 0.5
      - type: PackDetInputs
  val_subset:
    batch_size: 1
    transforms:
      - type: LoadImageFromFile
        backend_args: null
      - type: Resize
        keep_ratio: true
        scale:
          - 1344
          - 1344
      - type: LoadAnnotations
        with_bbox: true
        with_mask: true
      - type: PackDetInputs
        meta_keys:
          - img_id
          - img_path
          - ori_shape
          - img_shape
          - scale_factor
  test_subset:
    batch_size: 1
    transforms:
      - type: LoadImageFromFile
        backend_args: null
      - type: Resize
        keep_ratio: true
        scale:
          - 1344
          - 1344
      - type: LoadAnnotations
        with_bbox: true
        with_mask: true
      - type: PackDetInputs
        meta_keys:
          - img_id
          - img_path
          - ori_shape
          - img_shape
          - scale_factor

model:
  otx_model:
    _target_: otx.algo.instance_segmentation.maskrcnn.MaskRCNN
    variant: swint
  optimizer:
    _target_: torch.optim.AdamW
    _partial_: true
    lr: 0.0001
    weight_decay: 0.05
