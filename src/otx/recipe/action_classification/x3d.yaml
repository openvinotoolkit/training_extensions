# @package _global_
defaults:
  - override /base: action_classification
  - override /callbacks: action_classification
  - override /data: mmaction_classification
  - override /model: mmaction_classification
data:
  train_subset:
    batch_size: 8
    transforms:
      - type: LoadVideoForClassification
      - type: DecordInit
      - type: SampleFrames
        clip_len: 8
        frame_interval: 4
        num_clips: 1
        test_mode: true
      - type: DecordDecode
      - type: Resize
        scale:
          - -1
          - 256
      - type: Flip
        flip_ratio: 0.5
      - type: FormatShape
        input_format: NCTHW
      - type: PackActionInputs
        meta_keys:
          - img_shape
          - ori_shape
          - pad_shape
          - scale_factor
  val_subset:
    batch_size: 8
    transforms:
      - type: LoadVideoForClassification
      - type: DecordInit
      - type: SampleFrames
        clip_len: 8
        frame_interval: 4
        num_clips: 1
        test_mode: true
      - type: DecordDecode
      - type: Resize
        scale:
          - -1
          - 256
      - type: FormatShape
        input_format: NCTHW
      - type: PackActionInputs
        meta_keys:
          - img_shape
          - ori_shape
          - pad_shape
          - scale_factor
  test_subset:
    batch_size: 8
    transforms:
      - type: LoadVideoForClassification
      - type: DecordInit
      - type: SampleFrames
        clip_len: 8
        frame_interval: 4
        num_clips: 1
        test_mode: true
      - type: DecordDecode
      - type: Resize
        scale:
          - -1
          - 256
      - type: FormatShape
        input_format: NCTHW
      - type: PackActionInputs
        meta_keys:
          - img_shape
          - ori_shape
          - pad_shape
          - scale_factor
model:
  otx_model:
    _target_: otx.algo.action_classification.x3d.X3D
  optimizer:
    _target_: torch.optim.AdamW
    lr: 0.001
    weight_decay: 0.0001
