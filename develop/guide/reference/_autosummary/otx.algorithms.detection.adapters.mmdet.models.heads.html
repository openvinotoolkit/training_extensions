

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>otx.algorithms.detection.adapters.mmdet.models.heads &#8212; OpenVINO™ Training Extensions 1.6.0dev documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'guide/reference/_autosummary/otx.algorithms.detection.adapters.mmdet.models.heads';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="otx.algorithms.detection.adapters.mmdet.models.layers" href="otx.algorithms.detection.adapters.mmdet.models.layers.html" />
    <link rel="prev" title="otx.algorithms.detection.adapters.mmdet.models.detectors" href="otx.algorithms.detection.adapters.mmdet.models.detectors.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/otx-logo.png" class="logo__image only-light" alt="OpenVINO™ Training Extensions 1.6.0dev documentation - Home"/>
    <script>document.write(`<img src="../../../_static/otx-logo.png" class="logo__image only-dark" alt="OpenVINO™ Training Extensions 1.6.0dev documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/openvinotoolkit/training_extensions" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../../_static/logos/github_icon.png" class="icon-link-image" alt="GitHub"/></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/openvinotoolkit/training_extensions" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../../_static/logos/github_icon.png" class="icon-link-image" alt="GitHub"/></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../get_started/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../get_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../get_started/cli_commands.html">OpenVINO™ Training Extensions CLI commands</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/base/index.html">Base Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/base/how_to_train/index.html">How to train, validate, export and optimize the model</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/base/how_to_train/classification.html">Classification  model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/base/how_to_train/detection.html">Object Detection model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/base/how_to_train/instance_segmentation.html">Instance Segmentation model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/base/how_to_train/semantic_segmentation.html">Semantic Segmentation model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/base/how_to_train/anomaly_detection.html">Anomaly Detection Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/base/how_to_train/action_classification.html">Action Classification model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/base/how_to_train/action_detection.html">Action Detection model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/base/demo.html">How to run the demonstration mode with OpenVINO™ Training Extensions CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/base/deploy.html">How to deploy the model and use demo in exportable code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/base/explain.html">How to explain the model behavior</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/advanced/index.html">Advanced Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/advanced/semi_sl.html">Use Semi-Supervised Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/advanced/self_sl.html">Use Self-Supervised Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/advanced/backbones.html">Backbone Replacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/advanced/api_tutorial.html">Utilize OpenVINO™ Training Extensions APIs in your project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/advanced/hpo_tutorial.html">Simple HPO Tutorial</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Explanation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../explanation/algorithms/index.html">Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../explanation/algorithms/classification/index.html">Classification</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../explanation/algorithms/classification/multi_class_classification.html">Multi-class Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../explanation/algorithms/classification/multi_label_classification.html">Multi-label Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../explanation/algorithms/classification/hierarhical_classification.html">Hierarchical Classification</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../explanation/algorithms/object_detection/index.html">Object Detection</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../explanation/algorithms/object_detection/object_detection.html">Object Detection</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../explanation/algorithms/segmentation/index.html">Segmentation</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../explanation/algorithms/segmentation/semantic_segmentation.html">Semantic Segmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../explanation/algorithms/segmentation/instance_segmentation.html">Instance Segmentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../explanation/algorithms/anomaly/index.html">Anomaly Detection</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../explanation/algorithms/action/index.html">Action Recognition</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../explanation/algorithms/action/action_classification.html">Action Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../explanation/algorithms/action/action_detection.html">Action Detection</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../explanation/algorithms/visual_prompting/index.html">Visual Prompting</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../explanation/algorithms/visual_prompting/fine_tuning.html">Visual Prompting (Fine-tuning)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../explanation/algorithms/visual_prompting/zero_shot.html">Visual Prompting (Zero-shot learning)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../explanation/additional_features/index.html">Additional Features</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../explanation/additional_features/models_optimization.html">Models Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../explanation/additional_features/hpo.html">Hyperparameters Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../explanation/additional_features/auto_configuration.html">Auto-configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../explanation/additional_features/adaptive_training.html">Adaptive Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../explanation/additional_features/xai.html">Explainable AI (XAI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../explanation/additional_features/noisy_label_detection.html">Noisy Label Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../explanation/additional_features/fast_data_loading.html">Fast Data Loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../explanation/additional_features/tiling.html">Improve Small Object Detection with Image Tiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../explanation/additional_features/config_input_size.html">Configurable Input Size</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">API reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="otx.html">otx</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3 current active has-children"><a class="reference internal" href="otx.algorithms.html">otx.algorithms</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="otx.algorithms.action.html">otx.algorithms.action</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.algorithms.anomaly.html">otx.algorithms.anomaly</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.algorithms.classification.html">otx.algorithms.classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.algorithms.common.html">otx.algorithms.common</a></li>
<li class="toctree-l4 current active"><a class="reference internal" href="otx.algorithms.detection.html">otx.algorithms.detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.algorithms.segmentation.html">otx.algorithms.segmentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.algorithms.visual_prompting.html">otx.algorithms.visual_prompting</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="otx.api.html">otx.api</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="otx.api.configuration.html">otx.api.configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.api.entities.html">otx.api.entities</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.api.serialization.html">otx.api.serialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.api.usecases.html">otx.api.usecases</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.api.utils.html">otx.api.utils</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="otx.cli.html">otx.cli</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="otx.cli.builder.html">otx.cli.builder</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.cli.manager.html">otx.cli.manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.cli.registry.html">otx.cli.registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.cli.tools.html">otx.cli.tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.cli.utils.html">otx.cli.utils</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="otx.core.html">otx.core</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="otx.core.data.html">otx.core.data</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.core.file.html">otx.core.file</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.core.ov.html">otx.core.ov</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.core.patcher.html">otx.core.patcher</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="otx.hpo.html">otx.hpo</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="otx.recipes.html">otx.recipes</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="otx.recipes.stages.html">otx.recipes.stages</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="otx.utils.html">otx.utils</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="otx.utils.logger.html">otx.utils.logger</a></li>
<li class="toctree-l4"><a class="reference internal" href="otx.utils.utils.html">otx.utils.utils</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Release Notes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../release_notes/index.html">Releases</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">





<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">Guide</a></li>
    
    
    <li class="breadcrumb-item"><i class="fa-solid fa-ellipsis"></i></li>
    
    
    <li class="breadcrumb-item"><a href="otx.algorithms.detection.adapters.mmdet.models.html" class="nav-link">otx.algorithms.detection.adapters.mmdet.models</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">otx.algorith...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-otx.algorithms.detection.adapters.mmdet.models.heads">
<span id="otx-algorithms-detection-adapters-mmdet-models-heads"></span><h1>otx.algorithms.detection.adapters.mmdet.models.heads<a class="headerlink" href="#module-otx.algorithms.detection.adapters.mmdet.models.heads" title="Permalink to this heading">#</a></h1>
<p>Initial file for mmdetection heads.</p>
<p class="rubric">Classes</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead" title="otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CrossDatasetDetectorHead</span></code></a>([init_cfg])</p></td>
<td><p>Head class for Ignore labels.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.SSDAnchorGeneratorClustered" title="otx.algorithms.detection.adapters.mmdet.models.heads.SSDAnchorGeneratorClustered"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SSDAnchorGeneratorClustered</span></code></a>(strides, widths, ...)</p></td>
<td><p>Custom Anchor Generator for SSD.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead" title="otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CustomATSSHead</span></code></a>(*args[, bg_loss_weight, ...])</p></td>
<td><p>CustomATSSHead for OTX template.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead" title="otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CustomDINOHead</span></code></a>(*args[, dn_cfg])</p></td>
<td><p>Head of DINO.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomFCNMaskHead" title="otx.algorithms.detection.adapters.mmdet.models.heads.CustomFCNMaskHead"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CustomFCNMaskHead</span></code></a>([num_convs, ...])</p></td>
<td><p>Custom FCN Mask Head for fast mask evaluation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRetinaHead" title="otx.algorithms.detection.adapters.mmdet.models.heads.CustomRetinaHead"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CustomRetinaHead</span></code></a>(*args[, bg_loss_weight])</p></td>
<td><p>CustomRetinaHead class for OTX.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead" title="otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CustomSSDHead</span></code></a>(*args[, bg_loss_weight, ...])</p></td>
<td><p>CustomSSDHead class for OTX.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRoIHead" title="otx.algorithms.detection.adapters.mmdet.models.heads.CustomRoIHead"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CustomRoIHead</span></code></a>([bbox_roi_extractor, ...])</p></td>
<td><p>CustomROIHead class for OTX.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomVFNetHead" title="otx.algorithms.detection.adapters.mmdet.models.heads.CustomVFNetHead"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CustomVFNetHead</span></code></a>(*args[, bg_loss_weight])</p></td>
<td><p>CustomVFNetHead class for OTX.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomYOLOXHead" title="otx.algorithms.detection.adapters.mmdet.models.heads.CustomYOLOXHead"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CustomYOLOXHead</span></code></a>(*args, **kwargs)</p></td>
<td><p>CustomYOLOXHead class for OTX.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.DETRHeadExtension" title="otx.algorithms.detection.adapters.mmdet.models.heads.DETRHeadExtension"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DETRHeadExtension</span></code></a>([init_cfg])</p></td>
<td><p>Head of DETR.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRPNHead" title="otx.algorithms.detection.adapters.mmdet.models.heads.CustomRPNHead"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CustomRPNHead</span></code></a>(in_channels[, init_cfg, num_convs])</p></td>
<td><p>RPN head.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics" title="otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CustomATSSHeadTrackingLossDynamics</span></code></a>(*args[, ...])</p></td>
<td><p>CustomATSSHead which supports tracking loss dynamics.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">otx.algorithms.detection.adapters.mmdet.models.heads.</span></span><span class="sig-name descname"><span class="pre">CrossDatasetDetectorHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/cross_dataset_detector_head.html#CrossDatasetDetectorHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDenseHead</span></code></p>
<p>Head class for Ignore labels.</p>
<p>Initialize BaseModule, inherited from <cite>torch.nn.Module</cite></p>
<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead.get_atss_targets">
<span class="sig-name descname"><span class="pre">get_atss_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchor_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_flag_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_ignore_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unmap_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/cross_dataset_detector_head.html#CrossDatasetDetectorHead.get_atss_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead.get_atss_targets" title="Permalink to this definition">#</a></dt>
<dd><p>Get targets for Detection head.</p>
<p>This method is almost the same as <cite>AnchorHead.get_targets()</cite>. Besides
returning the targets as the parent method does, it also returns the
anchors as the first element of the returned tuple.
However, if the detector’s head loss uses CrossSigmoidFocalLoss,
the labels_weights_list consists of (binarized label schema * weights) of batch images</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead.get_fcos_targets">
<span class="sig-name descname"><span class="pre">get_fcos_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/cross_dataset_detector_head.html#CrossDatasetDetectorHead.get_fcos_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead.get_fcos_targets" title="Permalink to this definition">#</a></dt>
<dd><p>Compute regression, classification and centerss targets for points in multiple images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Points of each fpn level, each has shape
(num_points, 2).</p></li>
<li><p><strong>gt_bboxes_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Ground truth bboxes of each image,
each has shape (num_gt, 4).</p></li>
<li><p><strong>gt_labels_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Ground truth labels of each box,
each has shape (num_gt,).</p></li>
<li><p><strong>img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – Meta information for the image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>concat_lvl_labels (list[Tensor]): Labels of each level.                 concat_lvl_bbox_targets (list[Tensor]): BBox targets of each                     level.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead.get_valid_label_mask">
<span class="sig-name descname"><span class="pre">get_valid_label_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/cross_dataset_detector_head.html#CrossDatasetDetectorHead.get_valid_label_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead.get_valid_label_mask" title="Permalink to this definition">#</a></dt>
<dd><p>Getter function valid_label_mask.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead.vfnet_to_atss_targets">
<span class="sig-name descname"><span class="pre">vfnet_to_atss_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlvl_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/cross_dataset_detector_head.html#CrossDatasetDetectorHead.vfnet_to_atss_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead.vfnet_to_atss_targets" title="Permalink to this definition">#</a></dt>
<dd><p>A wrapper for computing ATSS targets for points in multiple images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls_scores</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Box iou-aware scores for each scale
level with shape (N, num_points * num_classes, H, W).</p></li>
<li><p><strong>mlvl_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Points of each fpn level, each has
shape (num_points, 2).</p></li>
<li><p><strong>gt_bboxes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Ground truth bboxes of each image,
each has shape (num_gt, 4).</p></li>
<li><p><strong>gt_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Ground truth labels of each box,
each has shape (num_gt,).</p></li>
<li><p><strong>img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – Meta information of each image, e.g.,
image size, scaling factor, etc.</p></li>
<li><p><strong>gt_bboxes_ignore</strong> (<em>None</em><em> | </em><em>Tensor</em>) – Ground truth bboxes to be
ignored, shape (num_ignored_gts, 4). Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>labels_list (list[Tensor]): Labels of each level.
label_weights (Tensor): Label weights of all levels.
bbox_targets_list (list[Tensor]): Regression targets of each</p>
<blockquote>
<div><p>level, (l, t, r, b).</p>
</div></blockquote>
<p>bbox_weights (Tensor): Bbox weights of all levels.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">otx.algorithms.detection.adapters.mmdet.models.heads.</span></span><span class="sig-name descname"><span class="pre">CustomATSSHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_loss_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_qfl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qfl_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_atss_head.html#CustomATSSHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead" title="otx.algorithms.detection.adapters.mmdet.models.heads.cross_dataset_detector_head.CrossDatasetDetectorHead"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossDatasetDetectorHead</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ATSSHead</span></code></p>
<p>CustomATSSHead for OTX template.</p>
<p>Initialize BaseModule, inherited from <cite>torch.nn.Module</cite></p>
<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead.forward_single">
<span class="sig-name descname"><span class="pre">forward_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_atss_head.html#CustomATSSHead.forward_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead.forward_single" title="Permalink to this definition">#</a></dt>
<dd><p>Forward feature of a single scale level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Features of a single scale level.</p></li>
<li><p><strong>(</strong> (<em>scale</em>) – obj: <cite>mmcv.cnn.Scale</cite>): Learnable scale module to resize
the bbox prediction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>cls_score (Tensor): Cls scores for a single scale level</dt><dd><p>the channels number is num_anchors * num_classes.</p>
</dd>
<dt>bbox_pred (Tensor): Box energies / deltas for a single scale</dt><dd><p>level, the channels number is num_anchors * 4.</p>
</dd>
<dt>centerness (Tensor): Centerness for a single scale level, the</dt><dd><p>channel number is (N, num_anchors * 1, H, W).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead.get_targets">
<span class="sig-name descname"><span class="pre">get_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchor_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_flag_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_ignore_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unmap_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_atss_head.html#CustomATSSHead.get_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead.get_targets" title="Permalink to this definition">#</a></dt>
<dd><p>Get targets for Detection head.</p>
<p>This method is almost the same as <cite>AnchorHead.get_targets()</cite>. Besides
returning the targets as the parent method does, it also returns the
anchors as the first element of the returned tuple.
However, if the detector’s head loss uses CrossSigmoidFocalLoss,
the labels_weights_list consists of (binarized label schema * weights) of batch images</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centernesses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_atss_head.html#CustomATSSHead.loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead.loss" title="Permalink to this definition">#</a></dt>
<dd><p>Compute losses of the head.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls_scores</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Box scores for each scale level
Has shape (N, num_anchors * num_classes, H, W)</p></li>
<li><p><strong>bbox_preds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Box energies / deltas for each scale
level with shape (N, num_anchors * 4, H, W)</p></li>
<li><p><strong>centernesses</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Centerness for each scale
level with shape (N, num_anchors * 1, H, W)</p></li>
<li><p><strong>gt_bboxes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Ground truth bboxes for each image with
shape (num_gts, 4) in [tl_x, tl_y, br_x, br_y] format.</p></li>
<li><p><strong>gt_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – class indices corresponding to each box</p></li>
<li><p><strong>img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – Meta information of each image, e.g.,
image size, scaling factor, etc.</p></li>
<li><p><strong>gt_bboxes_ignore</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>] </em><em>| </em><em>None</em>) – specify which bounding
boxes can be ignored when computing the loss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of loss components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead.loss_single">
<span class="sig-name descname"><span class="pre">loss_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centerness</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_label_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_total_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_atss_head.html#CustomATSSHead.loss_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead.loss_single" title="Permalink to this definition">#</a></dt>
<dd><p>Compute loss of a single scale level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>anchors</strong> (<em>Tensor</em>) – Box reference for each scale level with shape
(N, num_total_anchors, 4).</p></li>
<li><p><strong>cls_score</strong> (<em>Tensor</em>) – Box scores for each scale level
Has shape (N, num_anchors * num_classes, H, W).</p></li>
<li><p><strong>bbox_pred</strong> (<em>Tensor</em>) – Box energies / deltas for each scale
level with shape (N, num_anchors * 4, H, W).</p></li>
<li><p><strong>centerness</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Centerness for each scale
level with shape (N, num_anchors * num_classes, H, W)</p></li>
<li><p><strong>labels</strong> (<em>Tensor</em>) – Labels of each anchors with shape
(N, num_total_anchors).</p></li>
<li><p><strong>label_weights</strong> (<em>Tensor</em>) – Label weights of each anchor with shape
(N, num_total_anchors)</p></li>
<li><p><strong>bbox_targets</strong> (<em>Tensor</em>) – BBox regression targets of each anchor wight
shape (N, num_total_anchors, 4).</p></li>
<li><p><strong>valid_label_mask</strong> (<em>Tensor</em>) – Label mask for consideration of ignored
label with shape (N, num_total_anchors, 1).</p></li>
<li><p><strong>num_total_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of positive samples that is
reduced over all GPUs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of loss components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">otx.algorithms.detection.adapters.mmdet.models.heads.</span></span><span class="sig-name descname"><span class="pre">CustomATSSHeadTrackingLossDynamics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_loss_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_qfl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qfl_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_atss_head.html#CustomATSSHeadTrackingLossDynamics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TrackingLossDynamicsMixIn</span></code>, <a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead" title="otx.algorithms.detection.adapters.mmdet.models.heads.custom_atss_head.CustomATSSHead"><code class="xref py py-class docutils literal notranslate"><span class="pre">CustomATSSHead</span></code></a></p>
<p>CustomATSSHead which supports tracking loss dynamics.</p>
<p>Initialize BaseModule, inherited from <cite>torch.nn.Module</cite></p>
<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics.get_targets">
<span class="sig-name descname"><span class="pre">get_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchor_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_flag_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_ignore_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unmap_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_atss_head.html#CustomATSSHeadTrackingLossDynamics.get_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics.get_targets" title="Permalink to this definition">#</a></dt>
<dd><p>Get targets for Detection head.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centernesses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_atss_head.html#CustomATSSHeadTrackingLossDynamics.loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics.loss" title="Permalink to this definition">#</a></dt>
<dd><p>Compute losses of the head.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls_scores</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Box scores for each scale level
Has shape (N, num_anchors * num_classes, H, W)</p></li>
<li><p><strong>bbox_preds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Box energies / deltas for each scale
level with shape (N, num_anchors * 4, H, W)</p></li>
<li><p><strong>centernesses</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Centerness for each scale
level with shape (N, num_anchors * 1, H, W)</p></li>
<li><p><strong>gt_bboxes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Ground truth bboxes for each image with
shape (num_gts, 4) in [tl_x, tl_y, br_x, br_y] format.</p></li>
<li><p><strong>gt_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – class indices corresponding to each box</p></li>
<li><p><strong>img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – Meta information of each image, e.g.,
image size, scaling factor, etc.</p></li>
<li><p><strong>gt_bboxes_ignore</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>] </em><em>| </em><em>None</em>) – specify which bounding
boxes can be ignored when computing the loss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of loss components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics.loss_single">
<span class="sig-name descname"><span class="pre">loss_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centerness</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_label_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_total_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_atss_head.html#CustomATSSHeadTrackingLossDynamics.loss_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics.loss_single" title="Permalink to this definition">#</a></dt>
<dd><p>Compute loss of a single scale level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>anchors</strong> (<em>Tensor</em>) – Box reference for each scale level with shape
(N, num_total_anchors, 4).</p></li>
<li><p><strong>cls_score</strong> (<em>Tensor</em>) – Box scores for each scale level
Has shape (N, num_anchors * num_classes, H, W).</p></li>
<li><p><strong>bbox_pred</strong> (<em>Tensor</em>) – Box energies / deltas for each scale
level with shape (N, num_anchors * 4, H, W).</p></li>
<li><p><strong>centerness</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Centerness for each scale
level with shape (N, num_anchors * num_classes, H, W)</p></li>
<li><p><strong>labels</strong> (<em>Tensor</em>) – Labels of each anchors with shape
(N, num_total_anchors).</p></li>
<li><p><strong>label_weights</strong> (<em>Tensor</em>) – Label weights of each anchor with shape
(N, num_total_anchors)</p></li>
<li><p><strong>bbox_targets</strong> (<em>Tensor</em>) – BBox regression targets of each anchor wight
shape (N, num_total_anchors, 4).</p></li>
<li><p><strong>valid_label_mask</strong> (<em>Tensor</em>) – Label mask for consideration of ignored
label with shape (N, num_total_anchors, 1).</p></li>
<li><p><strong>num_total_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of positive samples that is
reduced over all GPUs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of loss components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">otx.algorithms.detection.adapters.mmdet.models.heads.</span></span><span class="sig-name descname"><span class="pre">CustomDINOHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dn_cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Config</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_dino_head.html#CustomDINOHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DeformableDETRHead</span></code>, <a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.DETRHeadExtension" title="otx.algorithms.detection.adapters.mmdet.models.heads.detr_head.DETRHeadExtension"><code class="xref py py-class docutils literal notranslate"><span class="pre">DETRHeadExtension</span></code></a></p>
<p>Head of DINO.</p>
<p>Based on detr_head.py and deformable_detr.py in mmdet2.x, some functions from dino_head.py in mmdet3.x are added.
Forward structure:</p>
<blockquote>
<div><ul class="simple">
<li><p>Training: self.forward_train -&gt; self.forward_transformer -&gt; self.forward -&gt; self.loss</p></li>
<li><p>Inference: self.simple_test_bboxes -&gt; self.forward_transformer -&gt; self.forward -&gt; self.get_bboxes</p></li>
</ul>
</div></blockquote>
<p>Initialize BaseModule, inherited from <cite>torch.nn.Module</cite></p>
<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">references</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_dino_head.html#CustomDINOHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Forward function.</p>
<p>Original implementation: forward function of deformable_detr_head.py in mmdet3.x
What’s changed: None</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_states</strong> (<em>Tensor</em>) – Hidden states output from each decoder
layer, has shape (num_decoder_layers, bs, num_queries, dim).</p></li>
<li><p><strong>references</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – List of the reference from the decoder.
The first reference is the <cite>init_reference</cite> (initial) and the
other num_decoder_layers(6) references are <cite>inter_references</cite>
(intermediate). The <cite>init_reference</cite> has shape (bs,
num_queries, 4) when <cite>as_two_stage</cite> of the detector is <cite>True</cite>,
otherwise (bs, num_queries, 2). Each <cite>inter_reference</cite> has
shape (bs, num_queries, 4) when <cite>with_box_refine</cite> of the
detector is <cite>True</cite>, otherwise (bs, num_queries, 2). The
coordinates are arranged as (cx, cy) when the last dimension is
2, and (cx, cy, w, h) when it is 4.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>results of head containing the following tensor.</p>
<ul class="simple">
<li><p>all_layers_outputs_classes (Tensor): Outputs from the
classification head, has shape (num_decoder_layers, bs,
num_queries, cls_out_channels).</p></li>
<li><p>all_layers_outputs_coords (Tensor): Sigmoid outputs from the
regression head with normalized coordinate format (cx, cy, w,
h), has shape (num_decoder_layers, bs, num_queries, 4) with the
last dimension arranged as (cx, cy, w, h).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>[Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.forward_train">
<span class="sig-name descname"><span class="pre">forward_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_ignore</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposal_cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Config</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_dino_head.html#CustomDINOHead.forward_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.forward_train" title="Permalink to this definition">#</a></dt>
<dd><p>Forward function for training mode.</p>
<p>Origin impelmentation: forward_train function of detr_head.py in mmdet2.x
What’s changed: Divided self.forward into self.forward_transformer + self.forward.
This kind of structure is from mmdet3.x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Features from backbone.</p></li>
<li><p><strong>img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – Meta information of each image, e.g.,
image size, scaling factor, etc.</p></li>
<li><p><strong>gt_bboxes</strong> (<em>List</em><em>[</em><em>Tensor</em><em>]</em>) – Ground truth bboxes of the image,
shape (num_gts, 4).</p></li>
<li><p><strong>gt_labels</strong> (<em>List</em><em>[</em><em>Tensor</em><em>]</em>) – Ground truth labels of each box,
shape (num_gts,).</p></li>
<li><p><strong>gt_bboxes_ignore</strong> (<em>List</em><em>[</em><em>Tensor</em><em>]</em>) – Ground truth bboxes to be
ignored, shape (num_ignored_gts, 4).</p></li>
<li><p><strong>proposal_cfg</strong> (<em>mmcv.Config</em>) – Test / postprocessing configuration,
if None, test_cfg would be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of loss components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.forward_transformer">
<span class="sig-name descname"><span class="pre">forward_transformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mlvl_feats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_dino_head.html#CustomDINOHead.forward_transformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.forward_transformer" title="Permalink to this definition">#</a></dt>
<dd><p>Transformers’s forward function.</p>
<p>Origin implementation: forward function of deformable_detr_head.py in mmdet2.x
What’s changed: Original implementation has post-processing process after getting outputs from</p>
<blockquote>
<div><p>self.transformer. However, this function directly return outputs from self.transformer</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mlvl_feats</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em>[</em><em>Tensor</em><em>]</em>) – Features from the upstream
network, each is a 4D-tensor with shape
(N, C, H, W).</p></li>
<li><p><strong>gt_bboxes</strong> (<em>List</em><em>[</em><em>Tensor</em><em> | </em><em>None</em><em>]</em>) – List of ground truth bboxes.
When model is evaluated, it will be list of None.</p></li>
<li><p><strong>gt_labels</strong> (<em>List</em><em>[</em><em>Tensor</em><em> | </em><em>None</em><em>]</em>) – List of ground truth labels.
When model is evaluated, it will be list of None.</p></li>
<li><p><strong>img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – List of image information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Outputs from the classification head,                 shape [nb_dec, bs, num_query, cls_out_channels]. Note                 cls_out_channels should includes background.
all_bbox_preds (Tensor): Sigmoid outputs from the regression                 head with normalized coordinate format (cx, cy, w, h).                 Shape [nb_dec, bs, num_query, 4].
enc_outputs_class (Tensor): The score of each point on encode                 feature map, has shape (N, h*w, num_class). Only when                 as_two_stage is True it would be returned, otherwise                 <cite>None</cite> would be returned.
enc_outputs_coord (Tensor): The proposal generate from the                 encode feature map, has shape (N, h*w, 4). Only when                 as_two_stage is True it would be returned, otherwise                 <cite>None</cite> would be returned.
dn_meta (Dict[str, int]): The dictionary saves information about</p>
<blockquote>
<div><p>group collation, including ‘num_denoising_queries’ and
‘num_denoising_groups’. It will be used for split outputs of
denoising and matching parts and loss calculation.</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>all_cls_scores (Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.get_dn_targets">
<span class="sig-name descname"><span class="pre">get_dn_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_gt_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Config</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_img_metas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dn_meta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><span class="pre">tuple</span></a></span></span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_dino_head.html#CustomDINOHead.get_dn_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.get_dn_targets" title="Permalink to this definition">#</a></dt>
<dd><p>Get targets in denoising part for a batch of images.</p>
<p>Original implementation: get_dn_targets function of dino_head.py in mmdet3.x
What’s changed: None</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_gt_instances</strong> (<em>List</em><em>[</em><em>Config</em><em>]</em>) – Batch of gt_instance.
It usually includes <code class="docutils literal notranslate"><span class="pre">bboxes</span></code> and <code class="docutils literal notranslate"><span class="pre">labels</span></code> attributes.</p></li>
<li><p><strong>batch_img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – Meta information of each image, e.g.,
image size, scaling factor, etc.</p></li>
<li><p><strong>dn_meta</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – The dictionary saves information about
group collation, including ‘num_denoising_queries’ and
‘num_denoising_groups’. It will be used for split outputs of
denoising and matching parts and loss calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>a tuple containing the following targets.</p>
<ul class="simple">
<li><p>labels_list (list[Tensor]): Labels for all images.</p></li>
<li><p>label_weights_list (list[Tensor]): Label weights for all images.</p></li>
<li><p>bbox_targets_list (list[Tensor]): BBox targets for all images.</p></li>
<li><p>bbox_weights_list (list[Tensor]): BBox weights for all images.</p></li>
<li><p>num_total_pos (int): Number of positive samples in all images.</p></li>
<li><p>num_total_neg (int): Number of negative samples in all images.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">references</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_outputs_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_outputs_coord</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dn_meta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_data_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Config</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_dino_head.html#CustomDINOHead.loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.loss" title="Permalink to this definition">#</a></dt>
<dd><p>Perform forward propagation and loss calculation.</p>
<p>Original implementation: loss function of dino_head.py in mmdet3.x
What’s changed: Change the name of function of loss_by_feat to loss_by_feat_two_stage since</p>
<blockquote>
<div><p>there are changes in function input from parent’s implementation.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_states</strong> (<em>Tensor</em>) – Hidden states output from each decoder
layer, has shape (num_decoder_layers, bs, num_queries_total,
dim), where <cite>num_queries_total</cite> is the sum of
<cite>num_denoising_queries</cite> and <cite>num_matching_queries</cite> when
<cite>self.training</cite> is <cite>True</cite>, else <cite>num_matching_queries</cite>.</p></li>
<li><p><strong>references</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – List of the reference from the decoder.
The first reference is the <cite>init_reference</cite> (initial) and the
other num_decoder_layers(6) references are <cite>inter_references</cite>
(intermediate). The <cite>init_reference</cite> has shape (bs,
num_queries_total, 4) and each <cite>inter_reference</cite> has shape
(bs, num_queries, 4) with the last dimension arranged as
(cx, cy, w, h).</p></li>
<li><p><strong>enc_outputs_class</strong> (<em>Tensor</em>) – The score of each point on encode
feature map, has shape (bs, num_feat_points, cls_out_channels).</p></li>
<li><p><strong>enc_outputs_coord</strong> (<em>Tensor</em>) – The proposal generate from the
encode feature map, has shape (bs, num_feat_points, 4) with the
last dimension arranged as (cx, cy, w, h).</p></li>
<li><p><strong>dn_meta</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – The dictionary saves information about
group collation, including ‘num_denoising_queries’ and
‘num_denoising_groups’. It will be used for split outputs of
denoising and matching parts and loss calculation.</p></li>
<li><p><strong>batch_data_samples</strong> (<em>List</em><em>[</em><em>Config</em><em>]</em>) – This is same with batch_data_samples in mmdet3.x
It contains meta_info(==img_metas) and gt_instances(==(gt_bboxes, gt_labels))</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of loss components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.loss_by_feat_two_stage">
<span class="sig-name descname"><span class="pre">loss_by_feat_two_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_layers_cls_scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_layers_bbox_preds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_cls_scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_bbox_preds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_gt_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Config</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_img_metas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dn_meta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_gt_instances_ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_dino_head.html#CustomDINOHead.loss_by_feat_two_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.loss_by_feat_two_stage" title="Permalink to this definition">#</a></dt>
<dd><p>Loss function.</p>
<p>Original implementation: loss_by_feat function of dino_head.py in mmdet3.x
What’s changed: Name of function is changed. Parent’s loss_by_feat function has different inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_layers_cls_scores</strong> (<em>Tensor</em>) – Classification scores of all
decoder layers, has shape (num_decoder_layers, bs,
num_queries_total, cls_out_channels), where
<cite>num_queries_total</cite> is the sum of <cite>num_denoising_queries</cite>
and <cite>num_matching_queries</cite>.</p></li>
<li><p><strong>all_layers_bbox_preds</strong> (<em>Tensor</em>) – Regression outputs of all decoder
layers. Each is a 4D-tensor with normalized coordinate format
(cx, cy, w, h) and has shape (num_decoder_layers, bs,
num_queries_total, 4).</p></li>
<li><p><strong>enc_cls_scores</strong> (<em>Tensor</em>) – The score of each point on encode
feature map, has shape (bs, num_feat_points, cls_out_channels).</p></li>
<li><p><strong>enc_bbox_preds</strong> (<em>Tensor</em>) – The proposal generate from the encode
feature map, has shape (bs, num_feat_points, 4) with the last
dimension arranged as (cx, cy, w, h).</p></li>
<li><p><strong>batch_gt_instances</strong> (<em>List</em><em>[</em><em>Config</em><em>]</em>) – Batch of gt_instance.
It usually includes <code class="docutils literal notranslate"><span class="pre">bboxes</span></code> and <code class="docutils literal notranslate"><span class="pre">labels</span></code> attributes.</p></li>
<li><p><strong>batch_img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – Meta information of each image, e.g.,
image size, scaling factor, etc.</p></li>
<li><p><strong>dn_meta</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – The dictionary saves information about
group collation, including ‘num_denoising_queries’ and
‘num_denoising_groups’. It will be used for split outputs of
denoising and matching parts and loss calculation.</p></li>
<li><p><strong>batch_gt_instances_ignore</strong> (list[<code class="xref py py-obj docutils literal notranslate"><span class="pre">InstanceData</span></code>], optional) – Batch of gt_instances_ignore. It includes <code class="docutils literal notranslate"><span class="pre">bboxes</span></code> attribute
data that is ignored during training and testing.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of loss components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.loss_dn">
<span class="sig-name descname"><span class="pre">loss_dn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_layers_denoising_cls_scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_layers_denoising_bbox_preds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_gt_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Config</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_img_metas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dn_meta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_dino_head.html#CustomDINOHead.loss_dn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.loss_dn" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate denoising loss.</p>
<p>Original implementation: loss_dn function of dino_head.py in mmdet3.x
What’s changed: None</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_layers_denoising_cls_scores</strong> (<em>Tensor</em>) – Classification scores of
all decoder layers in denoising part, has shape (
num_decoder_layers, bs, num_denoising_queries,
cls_out_channels).</p></li>
<li><p><strong>all_layers_denoising_bbox_preds</strong> (<em>Tensor</em>) – Regression outputs of all
decoder layers in denoising part. Each is a 4D-tensor with
normalized coordinate format (cx, cy, w, h) and has shape
(num_decoder_layers, bs, num_denoising_queries, 4).</p></li>
<li><p><strong>batch_gt_instances</strong> (<em>List</em><em>[</em><em>Config</em><em>]</em>) – Batch of gt_instance.
It usually includes <code class="docutils literal notranslate"><span class="pre">bboxes</span></code> and <code class="docutils literal notranslate"><span class="pre">labels</span></code> attributes.</p></li>
<li><p><strong>batch_img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – Meta information of each image, e.g.,
image size, scaling factor, etc.</p></li>
<li><p><strong>dn_meta</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – The dictionary saves information about
group collation, including ‘num_denoising_queries’ and
‘num_denoising_groups’. It will be used for split outputs of
denoising and matching parts and loss calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loss_dn_cls, loss_dn_bbox, and loss_dn_iou
of each decoder layers.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.simple_test_bboxes">
<span class="sig-name descname"><span class="pre">simple_test_bboxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_dino_head.html#CustomDINOHead.simple_test_bboxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.simple_test_bboxes" title="Permalink to this definition">#</a></dt>
<dd><p>Test det bboxes without test-time augmentation.</p>
<p>Original implementation: simple_test_bboxes funciton of detr_head.py in mmdet2.x
What’s changed: self.forward function is divided into self.forward_transformer and self.forward function.</p>
<blockquote>
<div><p>This changes is from mmdet3.x</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feats</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em>[</em><em>torch.Tensor</em><em>]</em>) – Multi-level features from the
upstream network, each is a 4D-tensor.</p></li>
<li><p><strong>img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – List of image information.</p></li>
<li><p><strong>rescale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to rescale the results.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Each item in result_list is 2-tuple.</dt><dd><p>The first item is <code class="docutils literal notranslate"><span class="pre">bboxes</span></code> with shape (n, 5),
where 5 represent (tl_x, tl_y, br_x, br_y, score).
The shape of the second tensor in the tuple is <code class="docutils literal notranslate"><span class="pre">labels</span></code>
with shape (n,)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>[Tensor, Tensor]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.split_outputs">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">split_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_layers_cls_scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_layers_bbox_preds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dn_meta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_dino_head.html#CustomDINOHead.split_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.split_outputs" title="Permalink to this definition">#</a></dt>
<dd><p>Split outputs of the denoising part and the matching part.</p>
<p>Original implementation: split_outputs function of dino_head.py in mmdet3.x
What’s changed: None</p>
<p>For the total outputs of <cite>num_queries_total</cite> length, the former
<cite>num_denoising_queries</cite> outputs are from denoising queries, and
the rest <cite>num_matching_queries</cite> ones are from matching queries,
where <cite>num_queries_total</cite> is the sum of <cite>num_denoising_queries</cite> and
<cite>num_matching_queries</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_layers_cls_scores</strong> (<em>Tensor</em>) – Classification scores of all
decoder layers, has shape (num_decoder_layers, bs,
num_queries_total, cls_out_channels).</p></li>
<li><p><strong>all_layers_bbox_preds</strong> (<em>Tensor</em>) – Regression outputs of all decoder
layers. Each is a 4D-tensor with normalized coordinate format
(cx, cy, w, h) and has shape (num_decoder_layers, bs,
num_queries_total, 4).</p></li>
<li><p><strong>dn_meta</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – The dictionary saves information about
group collation, including ‘num_denoising_queries’ and
‘num_denoising_groups’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>a tuple containing the following outputs.</p>
<ul class="simple">
<li><p>all_layers_matching_cls_scores (Tensor): Classification scores
of all decoder layers in matching part, has shape
(num_decoder_layers, bs, num_matching_queries, cls_out_channels).</p></li>
<li><p>all_layers_matching_bbox_preds (Tensor): Regression outputs of
all decoder layers in matching part. Each is a 4D-tensor with
normalized coordinate format (cx, cy, w, h) and has shape
(num_decoder_layers, bs, num_matching_queries, 4).</p></li>
<li><p>all_layers_denoising_cls_scores (Tensor): Classification scores
of all decoder layers in denoising part, has shape
(num_decoder_layers, bs, num_denoising_queries,
cls_out_channels).</p></li>
<li><p>all_layers_denoising_bbox_preds (Tensor): Regression outputs of
all decoder layers in denoising part. Each is a 4D-tensor with
normalized coordinate format (cx, cy, w, h) and has shape
(num_decoder_layers, bs, num_denoising_queries, 4).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomFCNMaskHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">otx.algorithms.detection.adapters.mmdet.models.heads.</span></span><span class="sig-name descname"><span class="pre">CustomFCNMaskHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_convs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roi_feat_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_agnostic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'scale_factor':</span> <span class="pre">2,</span> <span class="pre">'type':</span> <span class="pre">'deconv'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'Conv'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'loss_weight':</span> <span class="pre">1.0,</span> <span class="pre">'type':</span> <span class="pre">'CrossEntropyLoss',</span> <span class="pre">'use_mask':</span> <span class="pre">True}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_fcn_mask_head.html#CustomFCNMaskHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomFCNMaskHead" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FCNMaskHead</span></code></p>
<p>Custom FCN Mask Head for fast mask evaluation.</p>
<p>Initialize BaseModule, inherited from <cite>torch.nn.Module</cite></p>
<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomFCNMaskHead.get_scaled_seg_masks">
<span class="sig-name descname"><span class="pre">get_scaled_seg_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_fcn_mask_head.html#CustomFCNMaskHead.get_scaled_seg_masks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomFCNMaskHead.get_scaled_seg_masks" title="Permalink to this definition">#</a></dt>
<dd><p>Original method “get_seg_mask” from FCNMaskHead. Used in Semi-SL algorithm.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomFCNMaskHead.get_seg_masks">
<span class="sig-name descname"><span class="pre">get_seg_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">det_bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">det_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcnn_test_cfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_fcn_mask_head.html#CustomFCNMaskHead.get_seg_masks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomFCNMaskHead.get_seg_masks" title="Permalink to this definition">#</a></dt>
<dd><p>Get segmentation masks from mask_pred and bboxes.</p>
<p>The original <cite>FCNMaskHead.get_seg_masks</cite> grid sampled 28 x 28 masks to the original image resolution.
As a result, the resized masks occupy a large amount of memory and slow down the inference.
This method directly returns 28 x 28 masks and resize to bounding boxes size in post-processing step.
Doing so can save memory and speed up the inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_pred</strong> (<em>Tensor</em><em> or </em><em>ndarray</em>) – shape (n, #class, h, w).
For single-scale testing, mask_pred is the direct output of
model, whose type is Tensor, while for multi-scale testing,
it will be converted to numpy array outside of this method.</p></li>
<li><p><strong>det_bboxes</strong> (<em>Tensor</em>) – shape (n, 4/5)</p></li>
<li><p><strong>det_labels</strong> (<em>Tensor</em>) – shape (n, )</p></li>
<li><p><strong>rcnn_test_cfg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – rcnn testing config</p></li>
<li><p><strong>ori_shape</strong> (<em>Tuple</em>) – original image height and width, shape (2,)</p></li>
<li><p><strong>scale_factor</strong> (<em>ndarray</em><em> | </em><em>Tensor</em>) – If <code class="docutils literal notranslate"><span class="pre">rescale</span> <span class="pre">is</span> <span class="pre">True</span></code>, box
coordinates are divided by this scale factor to fit
<code class="docutils literal notranslate"><span class="pre">ori_shape</span></code>.</p></li>
<li><p><strong>rescale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – If True, the resulting masks will be rescaled to
<code class="docutils literal notranslate"><span class="pre">ori_shape</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>encoded masks. The c-th item in the outer list</dt><dd><p>corresponds to the c-th class. Given the c-th outer list, the
i-th item in that inner list is the mask for the i-th box with
class label c.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomRPNHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">otx.algorithms.detection.adapters.mmdet.models.heads.</span></span><span class="sig-name descname"><span class="pre">CustomRPNHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'layer':</span> <span class="pre">'Conv2d',</span> <span class="pre">'std':</span> <span class="pre">0.01,</span> <span class="pre">'type':</span> <span class="pre">'Normal'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_convs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_rpn_head.html#CustomRPNHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRPNHead" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RPNHead</span></code></p>
<p>RPN head.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of channels in the input feature map.</p></li>
<li><p><strong>init_cfg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em><em>, </em><em>optional</em>) – Initialization config dict.</p></li>
<li><p><strong>num_convs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of convolution layers in the head. Default 1.</p></li>
</ul>
</dd>
</dl>
<p>Initialize BaseModule, inherited from <cite>torch.nn.Module</cite></p>
<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomRPNHead.forward_single">
<span class="sig-name descname"><span class="pre">forward_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_rpn_head.html#CustomRPNHead.forward_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRPNHead.forward_single" title="Permalink to this definition">#</a></dt>
<dd><p>Forward feature map of a single scale level.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomRetinaHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">otx.algorithms.detection.adapters.mmdet.models.heads.</span></span><span class="sig-name descname"><span class="pre">CustomRetinaHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_loss_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_retina_head.html#CustomRetinaHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRetinaHead" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RetinaHead</span></code></p>
<p>CustomRetinaHead class for OTX.</p>
<p>Initialize BaseModule, inherited from <cite>torch.nn.Module</cite></p>
<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomRetinaHead.loss_single">
<span class="sig-name descname"><span class="pre">loss_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_total_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_retina_head.html#CustomRetinaHead.loss_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRetinaHead.loss_single" title="Permalink to this definition">#</a></dt>
<dd><p>Compute loss of a single scale level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls_score</strong> (<em>Tensor</em>) – Box scores for each scale level
Has shape (N, num_anchors * num_classes, H, W).</p></li>
<li><p><strong>bbox_pred</strong> (<em>Tensor</em>) – Box energies / deltas for each scale
level with shape (N, num_anchors * 4, H, W).</p></li>
<li><p><strong>anchors</strong> (<em>Tensor</em>) – Box reference for each scale level with shape
(N, num_total_anchors, 4).</p></li>
<li><p><strong>labels</strong> (<em>Tensor</em>) – Labels of each anchors with shape
(N, num_total_anchors).</p></li>
<li><p><strong>label_weights</strong> (<em>Tensor</em>) – Label weights of each anchor with shape
(N, num_total_anchors)</p></li>
<li><p><strong>bbox_targets</strong> (<em>Tensor</em>) – BBox regression targets of each anchor wight
shape (N, num_total_anchors, 4).</p></li>
<li><p><strong>bbox_weights</strong> (<em>Tensor</em>) – BBox regression loss weights of each anchor
with shape (N, num_total_anchors, 4).</p></li>
<li><p><strong>num_total_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – If sampling, num total samples equal to
the number of total anchors; Otherwise, it is the number of
positive anchors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of loss components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomRoIHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">otx.algorithms.detection.adapters.mmdet.models.heads.</span></span><span class="sig-name descname"><span class="pre">CustomRoIHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox_roi_extractor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_roi_extractor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_roi_head.html#CustomRoIHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRoIHead" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">StandardRoIHead</span></code></p>
<p>CustomROIHead class for OTX.</p>
<p>Initialize BaseModule, inherited from <cite>torch.nn.Module</cite></p>
<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomRoIHead.init_bbox_head">
<span class="sig-name descname"><span class="pre">init_bbox_head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox_roi_extractor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_head</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_roi_head.html#CustomRoIHead.init_bbox_head"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRoIHead.init_bbox_head" title="Permalink to this definition">#</a></dt>
<dd><p>Initialize <code class="docutils literal notranslate"><span class="pre">bbox_head</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">otx.algorithms.detection.adapters.mmdet.models.heads.</span></span><span class="sig-name descname"><span class="pre">CustomSSDHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_loss_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_balancing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_ssd_head.html#CustomSSDHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SSDHead</span></code></p>
<p>CustomSSDHead class for OTX.</p>
<p>Initialize BaseModule, inherited from <cite>torch.nn.Module</cite></p>
<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_ssd_head.html#CustomSSDHead.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead.forward" title="Permalink to this definition">#</a></dt>
<dd><p>Forward features from the upstream network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>feats</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a><em>[</em><em>Tensor</em><em>]</em>) – Features from the upstream network, each is
a 4D-tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>cls_scores (list[Tensor]): Classification scores for all scale</dt><dd><p>levels, each is a 4D-tensor, the channels number is
num_anchors * num_classes.</p>
</dd>
<dt>bbox_preds (list[Tensor]): Box energies / deltas for all scale</dt><dd><p>levels, each is a 4D-tensor, the channels number is
num_anchors * 4.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_ssd_head.html#CustomSSDHead.loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead.loss" title="Permalink to this definition">#</a></dt>
<dd><p>Loss function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead.loss_single">
<span class="sig-name descname"><span class="pre">loss_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_total_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_ssd_head.html#CustomSSDHead.loss_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead.loss_single" title="Permalink to this definition">#</a></dt>
<dd><p>Compute loss of a single image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls_score</strong> (<em>Tensor</em>) – Box scores for eachimage
Has shape (num_total_anchors, num_classes).</p></li>
<li><p><strong>bbox_pred</strong> (<em>Tensor</em>) – Box energies / deltas for each image
level with shape (num_total_anchors, 4).</p></li>
<li><p><strong>anchor</strong> (<em>Tensor</em>) – Box reference for each scale level with shape
(num_total_anchors, 4).</p></li>
<li><p><strong>labels</strong> (<em>Tensor</em>) – Labels of each anchors with shape
(num_total_anchors,).</p></li>
<li><p><strong>label_weights</strong> (<em>Tensor</em>) – Label weights of each anchor with shape
(num_total_anchors,)</p></li>
<li><p><strong>bbox_targets</strong> (<em>Tensor</em>) – BBox regression targets of each anchor
weight shape (num_total_anchors, 4).</p></li>
<li><p><strong>bbox_weights</strong> (<em>Tensor</em>) – BBox regression loss weights of each anchor
with shape (num_total_anchors, 4).</p></li>
<li><p><strong>num_total_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – If sampling, num total samples equal to
the number of total anchors; Otherwise, it is the number of
positive anchors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of loss components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomVFNetHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">otx.algorithms.detection.adapters.mmdet.models.heads.</span></span><span class="sig-name descname"><span class="pre">CustomVFNetHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_loss_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_vfnet_head.html#CustomVFNetHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomVFNetHead" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead" title="otx.algorithms.detection.adapters.mmdet.models.heads.cross_dataset_detector_head.CrossDatasetDetectorHead"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrossDatasetDetectorHead</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">VFNetHead</span></code></p>
<p>CustomVFNetHead class for OTX.</p>
<p>Initialize BaseModule, inherited from <cite>torch.nn.Module</cite></p>
<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomVFNetHead.get_targets">
<span class="sig-name descname"><span class="pre">get_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlvl_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_ignore</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_vfnet_head.html#CustomVFNetHead.get_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomVFNetHead.get_targets" title="Permalink to this definition">#</a></dt>
<dd><p>A wrapper for computing ATSS and FCOS targets for points in multiple images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls_scores</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Box iou-aware scores for each scale
level with shape (N, num_points * num_classes, H, W).</p></li>
<li><p><strong>mlvl_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Points of each fpn level, each has
shape (num_points, 2).</p></li>
<li><p><strong>gt_bboxes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Ground truth bboxes of each image,
each has shape (num_gt, 4).</p></li>
<li><p><strong>gt_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Ground truth labels of each box,
each has shape (num_gt,).</p></li>
<li><p><strong>img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – Meta information of each image, e.g.,
image size, scaling factor, etc.</p></li>
<li><p><strong>gt_bboxes_ignore</strong> (<em>None</em><em> | </em><em>Tensor</em>) – Ground truth bboxes to be
ignored, shape (num_ignored_gts, 4).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>labels_list (list[Tensor]): Labels of each level.
label_weights (Tensor/None): Label weights of all levels.
bbox_targets_list (list[Tensor]): Regression targets of each</p>
<blockquote>
<div><p>level, (l, t, r, b).</p>
</div></blockquote>
<p>bbox_weights (Tensor/None): Bbox weights of all levels.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomVFNetHead.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_preds_refine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_vfnet_head.html#CustomVFNetHead.loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomVFNetHead.loss" title="Permalink to this definition">#</a></dt>
<dd><p>Compute loss of the head.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls_scores</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Box iou-aware scores for each scale
level, each is a 4D-tensor, the channel number is
num_points * num_classes.</p></li>
<li><p><strong>bbox_preds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Box offsets for each
scale level, each is a 4D-tensor, the channel number is
num_points * 4.</p></li>
<li><p><strong>bbox_preds_refine</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Refined Box offsets for
each scale level, each is a 4D-tensor, the channel
number is num_points * 4.</p></li>
<li><p><strong>gt_bboxes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Ground truth bboxes for each image with
shape (num_gts, 4) in [tl_x, tl_y, br_x, br_y] format.</p></li>
<li><p><strong>gt_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – class indices corresponding to each box</p></li>
<li><p><strong>img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – Meta information of each image, e.g.,
image size, scaling factor, etc.</p></li>
<li><p><strong>gt_bboxes_ignore</strong> (<em>None</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – specify which bounding
boxes can be ignored when computing the loss.
Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of loss components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomYOLOXHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">otx.algorithms.detection.adapters.mmdet.models.heads.</span></span><span class="sig-name descname"><span class="pre">CustomYOLOXHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_yolox_head.html#CustomYOLOXHead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomYOLOXHead" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">YOLOXHead</span></code></p>
<p>CustomYOLOXHead class for OTX.</p>
<p>Initialize BaseModule, inherited from <cite>torch.nn.Module</cite></p>
<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomYOLOXHead.forward_single">
<span class="sig-name descname"><span class="pre">forward_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_convs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_convs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_reg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_yolox_head.html#CustomYOLOXHead.forward_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomYOLOXHead.forward_single" title="Permalink to this definition">#</a></dt>
<dd><p>Forward feature of a single scale level.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.CustomYOLOXHead.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objectnesses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_metas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes_ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_yolox_head.html#CustomYOLOXHead.loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomYOLOXHead.loss" title="Permalink to this definition">#</a></dt>
<dd><p>Compute loss of the head.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls_scores</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Box scores for each scale level,
each is a 4D-tensor, the channel number is
num_priors * num_classes.</p></li>
<li><p><strong>bbox_preds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Box energies / deltas for each scale
level, each is a 4D-tensor, the channel number is
num_priors * 4.</p></li>
<li><p><strong>objectnesses</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em><em>, </em><em>Optional</em>) – Score factor for
all scale level, each is a 4D-tensor, has shape
(batch_size, 1, H, W).</p></li>
<li><p><strong>gt_bboxes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – Ground truth bboxes for each image with
shape (num_gts, 4) in [tl_x, tl_y, br_x, br_y] format.</p></li>
<li><p><strong>gt_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – class indices corresponding to each box</p></li>
<li><p><strong>img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – Meta information of each image, e.g.,
image size, scaling factor, etc.</p></li>
<li><p><strong>gt_bboxes_ignore</strong> (<em>None</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – specify which bounding
boxes can be ignored when computing the loss.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.DETRHeadExtension">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">otx.algorithms.detection.adapters.mmdet.models.heads.</span></span><span class="sig-name descname"><span class="pre">DETRHeadExtension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/detr_head.html#DETRHeadExtension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.DETRHeadExtension" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModule</span></code></p>
<p>Head of DETR. DETR:End-to-End Object Detection with Transformers.</p>
<p>Origin implementation: DETRHead of detr_head.py in mmdet3.x
What’s changed: Change data type of batch_gt_instances from InstanceList to List[Config].</p>
<blockquote>
<div><p>Since InstanceList is a new data type from mmdet3.x, List[Config] will replace it.</p>
</div></blockquote>
<p>Initialize BaseModule, inherited from <cite>torch.nn.Module</cite></p>
<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.DETRHeadExtension.loss_by_feat">
<span class="sig-name descname"><span class="pre">loss_by_feat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_layers_cls_scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_layers_bbox_preds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_gt_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Config</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_img_metas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_gt_instances_ignore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/detr_head.html#DETRHeadExtension.loss_by_feat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.DETRHeadExtension.loss_by_feat" title="Permalink to this definition">#</a></dt>
<dd><p>Loss function.</p>
<p>Only outputs from the last feature level are used for computing
losses by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_layers_cls_scores</strong> (<em>Tensor</em>) – Classification outputs
of each decoder layers. Each is a 4D-tensor, has shape
(num_decoder_layers, bs, num_queries, cls_out_channels).</p></li>
<li><p><strong>all_layers_bbox_preds</strong> (<em>Tensor</em>) – Sigmoid regression
outputs of each decoder layers. Each is a 4D-tensor with
normalized coordinate format (cx, cy, w, h) and shape
(num_decoder_layers, bs, num_queries, 4).</p></li>
<li><p><strong>batch_gt_instances</strong> (<em>List</em><em>[</em><em>Config</em><em>]</em>) – Batch of gt_instance.
It usually includes <code class="docutils literal notranslate"><span class="pre">bboxes</span></code> and <code class="docutils literal notranslate"><span class="pre">labels</span></code> attributes.</p></li>
<li><p><strong>batch_img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – Meta information of each image, e.g.,
image size, scaling factor, etc.</p></li>
<li><p><strong>batch_gt_instances_ignore</strong> (list[<code class="xref py py-obj docutils literal notranslate"><span class="pre">InstanceData</span></code>], optional) – Batch of gt_instances_ignore. It includes <code class="docutils literal notranslate"><span class="pre">bboxes</span></code> attribute
data that is ignored during training and testing.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of loss components.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.DETRHeadExtension.loss_by_feat_single">
<span class="sig-name descname"><span class="pre">loss_by_feat_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_preds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_gt_instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Config</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_img_metas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/detr_head.html#DETRHeadExtension.loss_by_feat_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.DETRHeadExtension.loss_by_feat_single" title="Permalink to this definition">#</a></dt>
<dd><p>Loss function for outputs from a single decoder layer of a single feature level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls_scores</strong> (<em>Tensor</em>) – Box score logits from a single decoder layer
for all images, has shape (bs, num_queries, cls_out_channels).</p></li>
<li><p><strong>bbox_preds</strong> (<em>Tensor</em>) – Sigmoid outputs from a single decoder layer
for all images, with normalized coordinate (cx, cy, w, h) and
shape (bs, num_queries, 4).</p></li>
<li><p><strong>batch_gt_instances</strong> (<em>List</em><em>[</em><em>Config</em><em>]</em>) – Batch of gt_instance.
It usually includes <code class="docutils literal notranslate"><span class="pre">bboxes</span></code> and <code class="docutils literal notranslate"><span class="pre">labels</span></code> attributes.</p></li>
<li><p><strong>batch_img_metas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em>) – Meta information of each image, e.g.,
image size, scaling factor, etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple including <cite>loss_cls</cite>, <cite>loss_box</cite> and
<cite>loss_iou</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.SSDAnchorGeneratorClustered">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">otx.algorithms.detection.adapters.mmdet.models.heads.</span></span><span class="sig-name descname"><span class="pre">SSDAnchorGeneratorClustered</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">widths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reclustering_anchors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_anchor_generator.html#SSDAnchorGeneratorClustered"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.SSDAnchorGeneratorClustered" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AnchorGenerator</span></code></p>
<p>Custom Anchor Generator for SSD.</p>
<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.SSDAnchorGeneratorClustered.gen_base_anchors">
<span class="sig-name descname"><span class="pre">gen_base_anchors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_anchor_generator.html#SSDAnchorGeneratorClustered.gen_base_anchors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.SSDAnchorGeneratorClustered.gen_base_anchors" title="Permalink to this definition">#</a></dt>
<dd><p>Generate base anchor for SSD.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otx.algorithms.detection.adapters.mmdet.models.heads.SSDAnchorGeneratorClustered.gen_single_level_base_anchors">
<span class="sig-name descname"><span class="pre">gen_single_level_base_anchors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ws</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/otx/algorithms/detection/adapters/mmdet/models/heads/custom_anchor_generator.html#SSDAnchorGeneratorClustered.gen_single_level_base_anchors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#otx.algorithms.detection.adapters.mmdet.models.heads.SSDAnchorGeneratorClustered.gen_single_level_base_anchors" title="Permalink to this definition">#</a></dt>
<dd><p>Generate single_level_base_anchors for SSD.</p>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="otx.algorithms.detection.adapters.mmdet.models.detectors.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">otx.algorithms.detection.adapters.mmdet.models.detectors</p>
      </div>
    </a>
    <a class="right-next"
       href="otx.algorithms.detection.adapters.mmdet.models.layers.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">otx.algorithms.detection.adapters.mmdet.models.layers</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead"><code class="docutils literal notranslate"><span class="pre">CrossDatasetDetectorHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead.get_atss_targets"><code class="docutils literal notranslate"><span class="pre">CrossDatasetDetectorHead.get_atss_targets()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead.get_fcos_targets"><code class="docutils literal notranslate"><span class="pre">CrossDatasetDetectorHead.get_fcos_targets()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead.get_valid_label_mask"><code class="docutils literal notranslate"><span class="pre">CrossDatasetDetectorHead.get_valid_label_mask()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CrossDatasetDetectorHead.vfnet_to_atss_targets"><code class="docutils literal notranslate"><span class="pre">CrossDatasetDetectorHead.vfnet_to_atss_targets()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead"><code class="docutils literal notranslate"><span class="pre">CustomATSSHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead.forward_single"><code class="docutils literal notranslate"><span class="pre">CustomATSSHead.forward_single()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead.get_targets"><code class="docutils literal notranslate"><span class="pre">CustomATSSHead.get_targets()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead.loss"><code class="docutils literal notranslate"><span class="pre">CustomATSSHead.loss()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHead.loss_single"><code class="docutils literal notranslate"><span class="pre">CustomATSSHead.loss_single()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics"><code class="docutils literal notranslate"><span class="pre">CustomATSSHeadTrackingLossDynamics</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics.get_targets"><code class="docutils literal notranslate"><span class="pre">CustomATSSHeadTrackingLossDynamics.get_targets()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics.loss"><code class="docutils literal notranslate"><span class="pre">CustomATSSHeadTrackingLossDynamics.loss()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomATSSHeadTrackingLossDynamics.loss_single"><code class="docutils literal notranslate"><span class="pre">CustomATSSHeadTrackingLossDynamics.loss_single()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead"><code class="docutils literal notranslate"><span class="pre">CustomDINOHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.forward"><code class="docutils literal notranslate"><span class="pre">CustomDINOHead.forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.forward_train"><code class="docutils literal notranslate"><span class="pre">CustomDINOHead.forward_train()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.forward_transformer"><code class="docutils literal notranslate"><span class="pre">CustomDINOHead.forward_transformer()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.get_dn_targets"><code class="docutils literal notranslate"><span class="pre">CustomDINOHead.get_dn_targets()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.loss"><code class="docutils literal notranslate"><span class="pre">CustomDINOHead.loss()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.loss_by_feat_two_stage"><code class="docutils literal notranslate"><span class="pre">CustomDINOHead.loss_by_feat_two_stage()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.loss_dn"><code class="docutils literal notranslate"><span class="pre">CustomDINOHead.loss_dn()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.simple_test_bboxes"><code class="docutils literal notranslate"><span class="pre">CustomDINOHead.simple_test_bboxes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomDINOHead.split_outputs"><code class="docutils literal notranslate"><span class="pre">CustomDINOHead.split_outputs()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomFCNMaskHead"><code class="docutils literal notranslate"><span class="pre">CustomFCNMaskHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomFCNMaskHead.get_scaled_seg_masks"><code class="docutils literal notranslate"><span class="pre">CustomFCNMaskHead.get_scaled_seg_masks()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomFCNMaskHead.get_seg_masks"><code class="docutils literal notranslate"><span class="pre">CustomFCNMaskHead.get_seg_masks()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRPNHead"><code class="docutils literal notranslate"><span class="pre">CustomRPNHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRPNHead.forward_single"><code class="docutils literal notranslate"><span class="pre">CustomRPNHead.forward_single()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRetinaHead"><code class="docutils literal notranslate"><span class="pre">CustomRetinaHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRetinaHead.loss_single"><code class="docutils literal notranslate"><span class="pre">CustomRetinaHead.loss_single()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRoIHead"><code class="docutils literal notranslate"><span class="pre">CustomRoIHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomRoIHead.init_bbox_head"><code class="docutils literal notranslate"><span class="pre">CustomRoIHead.init_bbox_head()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead"><code class="docutils literal notranslate"><span class="pre">CustomSSDHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead.forward"><code class="docutils literal notranslate"><span class="pre">CustomSSDHead.forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead.loss"><code class="docutils literal notranslate"><span class="pre">CustomSSDHead.loss()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomSSDHead.loss_single"><code class="docutils literal notranslate"><span class="pre">CustomSSDHead.loss_single()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomVFNetHead"><code class="docutils literal notranslate"><span class="pre">CustomVFNetHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomVFNetHead.get_targets"><code class="docutils literal notranslate"><span class="pre">CustomVFNetHead.get_targets()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomVFNetHead.loss"><code class="docutils literal notranslate"><span class="pre">CustomVFNetHead.loss()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomYOLOXHead"><code class="docutils literal notranslate"><span class="pre">CustomYOLOXHead</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomYOLOXHead.forward_single"><code class="docutils literal notranslate"><span class="pre">CustomYOLOXHead.forward_single()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.CustomYOLOXHead.loss"><code class="docutils literal notranslate"><span class="pre">CustomYOLOXHead.loss()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.DETRHeadExtension"><code class="docutils literal notranslate"><span class="pre">DETRHeadExtension</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.DETRHeadExtension.loss_by_feat"><code class="docutils literal notranslate"><span class="pre">DETRHeadExtension.loss_by_feat()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.DETRHeadExtension.loss_by_feat_single"><code class="docutils literal notranslate"><span class="pre">DETRHeadExtension.loss_by_feat_single()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.SSDAnchorGeneratorClustered"><code class="docutils literal notranslate"><span class="pre">SSDAnchorGeneratorClustered</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.SSDAnchorGeneratorClustered.gen_base_anchors"><code class="docutils literal notranslate"><span class="pre">SSDAnchorGeneratorClustered.gen_base_anchors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#otx.algorithms.detection.adapters.mmdet.models.heads.SSDAnchorGeneratorClustered.gen_single_level_base_anchors"><code class="docutils literal notranslate"><span class="pre">SSDAnchorGeneratorClustered.gen_single_level_base_anchors()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../../_sources/guide/reference/_autosummary/otx.algorithms.detection.adapters.mmdet.models.heads.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, OpenVINO™ Training Extensions Contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>